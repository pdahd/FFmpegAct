name: Verify Tools

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  verify:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y autoconf automake build-essential cmake git libtool pkg-config texinfo zlib1g-dev yasm

    - name: Install gas-preprocessor
      run: |
        git clone https://github.com/FFmpeg/gas-preprocessor
        sudo cp gas-preprocessor/gas-preprocessor.pl /usr/local/bin/
        sudo chmod +x /usr/local/bin/gas-preprocessor.pl

    - name: Verify GNU assembler
      run: |
        if command -v as > /dev/null; then
          echo "GNU assembler found at: $(command -v as)"
        else
          echo "GNU assembler not found"
        fi

    - name: Verify gas-preprocessor
      run: |
        if command -v gas-preprocessor.pl > /dev/null; then
          echo "gas-preprocessor found at: $(command -v gas-preprocessor.pl)"
        else
          echo "gas-preprocessor not found"
        fi

    - name: Verify yasm
      run: |
        if command -v yasm > /dev/null; then
          echo "yasm found at: $(command -v yasm)"
        else
          echo "yasm not found"
        fi

    - name: Verify clang
      run: |
        if command -v clang > /dev/null; then
          echo "clang found at: $(command -v clang)"
        else
          echo "clang not found"
        fi

    - name: Verify clang++
      run: |
        if command -v clang++ > /dev/null; then
          echo "clang++ found at: $(command -v clang++)"
        else
          echo "clang++ not found"
        fi

    - name: Verify llvm-nm
      run: |
        if command -v llvm-nm > /dev/null; then
          echo "llvm-nm found at: $(command -v llvm-nm)"
        else
          echo "llvm-nm not found"
        fi

    - name: Verify ar
      run: |
        if command -v ar > /dev/null; then
          echo "ar found at: $(command -v ar)"
        else
          echo "ar not found"
        fi

    - name: Verify ld
      run: |
        if command -v ld > /dev/null; then
          echo "ld found at: $(command -v ld)"
        else
          echo "ld not found"
        fi

    - name: Verify strip
      run: |
        if command -v strip > /dev/null; then
          echo "strip found at: $(command -v strip)"
        else
          echo "strip not found"
        fi
